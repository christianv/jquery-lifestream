function imagePreloading(){var a=[],b=0,c=arguments.length;while(b<c)a[b]=new Image,a[b].src=arguments[b++]}function buildScript(a,b){var c=[],d=1+a.length,e=function(a){c.push(a),--d||($.n("All src moduled received"),$.n("Uglification..."),b(uglify(c.join(";"))))};$.n("Fetching src modules..."),$.getScript("../src/core.js",function(b){e(b),$.each(a,function(a,b){$.getScript("../src/services/"+b+".js",function(a){e(a)})})})}function onDownloadComplete(){$('#services input[type="checkbox"]').button("enable"),$("#button-bar > object").css({visibility:"hidden"}),$button.button("option",{icons:{primary:"ui-icon-gear"},label:"Build script",disabled:!1}).show().blur()}function onBuildCompleted(a){$.n("Build completed"),builtScript=a,$button.button("disable").hide(),$downloadify.css({visibility:"visible"})}function build(){$.n("Build started"),$('#services input[type="checkbox"]').button("disable"),$button.button("option",{disabled:!0,label:"Wait...",icons:{primary:"ui-icon-spinner"}}).button("widget").removeClass("ui-state-hover"),buildScript($('#services input[type="checkbox"]').filter(":checked").map(function(){return $(this).attr("id")}).get(),onBuildCompleted)}function buildUI(a){$("#startup-feedback").hide(),$.n(a.length+" services available");var b=[];$.each(a,function(a,c){b.push('<li><input id="'+c+'" type="checkbox"><label for="'+c+'">'+c+"</label></li>")}),b.push('<br class="clear">'),$("#services").append(b.join("")),$('#services input[type="checkbox"]').each(function(){$(this).button({text:!1,icons:{primary:"ui-icon-service-"+this.id}})}),$("#services").delegate('#services input[type="checkbox"]',"change",function(){var a=0;return function(){this.checked?a++:a--,$button.button(a>0?"enable":"disable")}}()),$button.button({icons:{primary:"ui-icon-gear"},disabled:!0}).click(function(){build();return!1}).show(),Downloadify.create("button-bar",{filename:function(){return"jquery.lifestream.min.js"},data:function(){return builtScript},onComplete:onDownloadComplete,onError:function(){alert("You must put something in the File Contents or there will be nothing to save!")},transparent:!1,swf:"js/downloadify.swf",downloadImage:"img/button-download.png",width:123,height:35,append:!0}),$downloadify=$("#button-bar > object").css({visibility:"hidden"})}$.n.defaults.timeout=8e3;var $button=$("#button"),$downloadify,builtScript="";imagePreloading("img/services-deselected.png","img/services-hover.png","img/services-selected.png","img/button-download.png"),$.n("Fetching available services..."),$.ajax({url:"services.json",dataType:"json",success:buildUI})